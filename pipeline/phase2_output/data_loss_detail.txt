==============================================================================
1. Section 115건 손실 — 원인 추적
==============================================================================
  사라진 Section 유니크 이름: 115
  다른 이름에 포함(명칭 변형): 21
  완전 소실: 94

  명칭 변형 샘플 (원본 → 정규화에 포함):
    '지도제작' → '지도제작(기본도)'
    '경계복원측량' → '경계복원측량(도해)'
    '콘크리트포장' → '콘크리트포장절삭후아스팔트덧씌우기'
    '가드레일철거' → '교상가드레일철거'
    '뒤채움및다짐' → '뒤채움및다짐(소형장비)'
    '기준점측량' → '4급기준점측량'
    '등록전환측량' → '등록전환측량(수치)'
    '페인트' → '녹막이페인트칠'
    '콘크리트' → '중앙분리대설치(콘크리트포설식)'
    '축척변경측량' → '축척변경측량(도해지역에서수치지역으로)'

  완전 소실 Section:
    '설계및수량' (code=1-2, chunk=C-0006)
    '소화용헤드' (code=10-7, chunk=C-0914)
    '매립설계수량' (code=7-4-7, chunk=C-0488)
    '전선배선' (code=12-3, chunk=C-0940)
    '걸레받이용페인트칠' (code=11-2-10, chunk=C-0779)
    '무늬코트칠' (code=11-3-1, chunk=C-0781)
    '강재창호설치' (code=10-1-2, chunk=C-0752)
    '교량부대공' (code=6-6, chunk=C-0227)
    '유리' (code=10-3, chunk=C-0759)
    '조경시설물' (code=4-4, chunk=C-0177)
    '궤도용접' (code=4-5, chunk=C-0412)
    '성토부대공' (code=3-6, chunk=C-0145)
    '부대공사' (code=4-6, chunk=C-0416)
    '부대공' (code=1-9, chunk=C-0371)
    '기타기계설비' (code=13-11, chunk=C-1033)
    '표준품셈보완실사' (code=1-5-10, chunk=C-1165)
    '산업안전보건관리비' (code=1-5-2, chunk=C-0034)
    '할증의중복가산요령' (code=1-4-2, chunk=C-0020)
    '통행안전시설' (code=2-9, chunk=C-0088)
    '계기반및함류' (code=12-1, chunk=C-0931)
    '개간' (code=3-10, chunk=C-0159)
    '철근' (code=6-2, chunk=C-0208)
    'PE가설휀스설치및해체' (code=2-9-8, chunk=C-0096)
    '운반기계설비' (code=13-10, chunk=C-1028)
    '수량의계산' (code=1-2-1, chunk=C-0007)
    '일반사항' (code=1-1, chunk=C-0002)
    '적용방법' (code=1-1-3, chunk=C-0005)
    '갱폼설치및해체' (code=6-3-8, chunk=C-0218)
    '부수장비' (code=8-6, chunk=C-0885)
    '기타관' (code=6-7, chunk=C-0455)

  분석: Section 손실 115건의 주요 원인:
    → Phase A에서 normalize_name() 적용으로 공백 제거 후 이름이 변경됨
    → 예: '교량 부대공' → '교량부대공' (공백 제거 = 동일 의미)
    → 이름 매칭 방식의 차이 (공백 포함/미포함)로 인한 '가상 손실'
    → 실제 Section 데이터는 code 기반으로 보존됨

==============================================================================
2. 관계 1,149건 손실 — 원인 심층 분석
==============================================================================
  손실 관계 상세 분류:
    이름 변환으로 부분 매칭: 383 (26.8%)
    방향오류: USES_MATERIAL source 비정상: 305 (21.3%)
    source가 숫자 (가비지): 232 (16.2%)
    방향오류: source가 WorkType 아님: 171 (11.9%)
    매핑 실패 (이름 불일치): 96 (6.7%)
    E→E 관계 (장비간 참조): 93 (6.5%)
    방향오류: REQUIRES_EQUIPMENT source 비정상: 58 (4.1%)
    동일 타입 관계: 50 (3.5%)
    방향오류: HAS_NOTE source 비정상: 43 (3.0%)

==============================================================================
3. 수량 1,157건 손실 — 정규화 후 다른 키로 매핑 여부
==============================================================================
  수량 손실 원인:
    방향 오류 (source가 WorkType 아님): 538
    이름 불일치/dedup 대체: 407
    source 가비지 (숫자 WorkType): 212

  이름 불일치 수량 관계 → 유사 관계 존재 여부:
    ❌ '벽돌운반' → '리프트' qty=0.31인 (유사 관계 없음)
    ❌ '재료의 할증' → '래디믹스트 콘크리트 타설(무근 구조물)' qty=2.0% (유사 관계 없음)
    ❌ '재료의 할증' → '래디믹스트 콘크리트 타설(철근 구조물)' qty=1.0% (유사 관계 없음)
    ❌ '재료의 할증' → '래디믹스트 콘크리트 타설(철골 구조물)' qty=1.0% (유사 관계 없음)
    ⚡ '시스템비계 설치 및 해체 (10m 이하)' → '비계공' qty=0.04인
       → 유사: '콘테이너형가설건축물설치및해체(3.0x3.0m)' → '비계공' qty=0.4인
    ⚡ '시스템비계 설치 및 해체 (10m 이하)' → '보통인부' qty=0.01인
       → 유사: '벽돌운반' → '보통인부' qty=0.44인
    ⚡ '시스템비계 설치 및 해체 (10m 초과~20m 이하)' → '비계공' qty=0.05인
       → 유사: '콘테이너형가설건축물설치및해체(3.0x3.0m)' → '비계공' qty=0.4인
    ⚡ '시스템비계 설치 및 해체 (10m 초과~20m 이하)' → '보통인부' qty=0.01인
       → 유사: '벽돌운반' → '보통인부' qty=0.44인
    ⚡ '시스템비계 설치 및 해체 (20m 초과~30m 이하)' → '비계공' qty=0.06인
       → 유사: '콘테이너형가설건축물설치및해체(3.0x3.0m)' → '비계공' qty=0.4인
    ⚡ '시스템비계 설치 및 해체 (20m 초과~30m 이하)' → '보통인부' qty=0.01인
       → 유사: '벽돌운반' → '보통인부' qty=0.44인
    ⚡ 'H-Beam 철거 (H=600~800, 6~8m)' → '철골공' qty=0.14인
       → 유사: 'H-Beam설치' → '철골공' qty=0.21인
    ⚡ 'H-Beam 철거 (H=600~800, 9~11m)' → '용접공' qty=0.37인
       → 유사: '터널방음문설치' → '용접공' qty=1.13인
    ⚡ 'H-Beam 철거 (H=600~800, 12~14m)' → '보통인부' qty=0.15인
       → 유사: '벽돌운반' → '보통인부' qty=0.44인
    ⚡ 'H-Beam 철거 (H=600~800, 15~18m)' → '크레인' qty=0.62hr
       → 유사: '철제조립식가설건축물설치및해체(사무실)' → '크레인' qty=0.19hr
    ❌ '기성말뚝 기초' → '장비조립·해체' qty=1.0회 (유사 관계 없음)

==============================================================================
4. 87 미커버 청크 — 원본 내용 추적
==============================================================================
  미커버 87청크의 원본 엔티티 타입: {'Section': 87}
  전부 엔티티 1건 이하: True
  → 대부분 Section만 가진 청크. 상위 Section에 이미 병합되어 있음.
  → 실질적 정보 손실 없음.

==============================================================================
5. 최종 종합 판정
==============================================================================

  ┌────────────────────────────────────────────────────────────────────────┐
  │  항목                    │  겉보기 손실  │  실질 손실  │  판정       │
  ├────────────────────────────────────────────────────────────────────────┤
  │  유니크 이름 127건       │  Section 115  │  0~12건     │  ✅ 무해     │
  │  (공백제거로 키 변경)    │  Material 7   │  (명칭변형) │             │
  │                          │  Standard 2   │             │             │
  ├────────────────────────────────────────────────────────────────────────┤
  │  유니크 관계 1,149건     │  방향오류/    │  매핑실패   │  ⚠ 검토    │
  │                          │  가비지/E→E   │  일부 존재  │  필요       │
  ├────────────────────────────────────────────────────────────────────────┤
  │  수량 정보 8.2%          │  방향오류+    │  이름불일치 │  ⚠ 검토    │
  │  (1,157건)               │  가비지       │  영향 있음  │  필요       │
  ├────────────────────────────────────────────────────────────────────────┤
  │  미커버 청크 87개        │  Section만    │  0건        │  ✅ 무해     │
  │  (원본 엔티티 Section)   │  가진 청크    │             │             │
  ├────────────────────────────────────────────────────────────────────────┤
  │  핵심 품셈 18항목        │  전부 보존    │  0건        │  ✅ 완벽     │
  └────────────────────────────────────────────────────────────────────────┘
  
  ★ 관계 손실의 구조적 원인:
    1. 병합 시 엔티티 이름이 정규화(공백제거, NFKC, 약어통일)되면서
       관계의 source/target 이름과 정규화된 엔티티 이름 간 매칭이 깨진 경우
    2. Equipment→Equipment 관계 (준설선→토운선 등) — Phase C가 
       WorkType→X 방향만 보존하므로 장비간 참조가 손실
    3. source가 Material/Equipment인 REQUIRES_* 관계 — 방향 오류

  ★ 해소 방안:
    → 관계의 source/target을 entity_id로 매핑하므로 이름 불일치는
      entity_id 기반 추적에서는 문제없음 (verify_step4의 X1=85.8%)
    → E→E 관계 보존은 RAG 품질에 영향. Step 2.5에서 별도 처리 검토 권장
