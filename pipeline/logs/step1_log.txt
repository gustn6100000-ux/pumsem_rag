🚀 하이브리드 PDF 추출 시작
   파일: 업로드 자료\00. 파싱 자료\PDF파일\595-603 OKOK.pdf
   모델: gemini-3-flash-preview
   방식: Python(텍스트) + Gemini(테이블)
   페이지: 9페이지 선택됨
   목차: 697개 섹션 매핑

📄 하이브리드 모드 PDF 처리 중: 업로드 자료\00. 파싱 자료\PDF파일\595-603 OKOK.pdf
    📚 페이지 기반 목차 매핑: 338개 페이지
📄 총 9페이지 중 9페이지 처리 예정

🔄 페이지 1 (1/9) 처리 중...
    📖 컨텍스트 유지: 9-17-4 (PDF 페이지 545)
    📊 테이블 4개 감지
    🔧 테이블 bbox 보정됨: 4개 → 4개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1217+545)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1214+210)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1247+233)
    🖼️ 테이블 4 크롭 및 Gemini 전송...
      ✅ 테이블 4 완료 (토큰: 1192+197)

🔄 페이지 2 (2/9) 처리 중...
    📖 목차 매핑: 1개 섹션 (PDF 페이지 546)
    📊 테이블 5개 감지
    🔧 테이블 bbox 보정됨: 5개 → 5개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1204+422)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1196+541)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1222+485)
    🖼️ 테이블 4 크롭 및 Gemini 전송...
      ✅ 테이블 4 완료 (토큰: 1213+463)
    🖼️ 테이블 5 크롭 및 Gemini 전송...
      ✅ 테이블 5 완료 (토큰: 1213+294)

🔄 페이지 3 (3/9) 처리 중...
    📖 컨텍스트 유지: 1-1-4 (PDF 페이지 547)
    📊 테이블 5개 감지
    🔧 테이블 bbox 보정됨: 5개 → 5개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1242+347)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1222+240)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1222+260)
    🖼️ 테이블 4 크롭 및 Gemini 전송...
      ✅ 테이블 4 완료 (토큰: 1204+380)
    🖼️ 테이블 5 크롭 및 Gemini 전송...
      ✅ 테이블 5 완료 (토큰: 1230+189)

🔄 페이지 4 (4/9) 처리 중...
    📖 컨텍스트 유지: 1-1-4 (PDF 페이지 548)
    📊 테이블 6개 감지
    🔧 테이블 bbox 보정됨: 6개 → 6개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1234+447)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1222+390)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1196+413)
    🖼️ 테이블 4 크롭 및 Gemini 전송...
      ✅ 테이블 4 완료 (토큰: 1222+405)
    🖼️ 테이블 5 크롭 및 Gemini 전송...
      ✅ 테이블 5 완료 (토큰: 1202+432)
    🖼️ 테이블 6 크롭 및 Gemini 전송...
      ✅ 테이블 6 완료 (토큰: 1213+461)

🔄 페이지 5 (5/9) 처리 중...
    📖 컨텍스트 유지: 1-1-4 (PDF 페이지 549)
    📊 테이블 4개 감지
    🔧 테이블 bbox 보정됨: 4개 → 4개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1255+316)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1246+313)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1222+201)
    🖼️ 테이블 4 크롭 및 Gemini 전송...
      ✅ 테이블 4 완료 (토큰: 1234+66)

🔄 페이지 6 (6/9) 처리 중...
    📖 컨텍스트 유지: 1-1-4 (PDF 페이지 550)
    📊 테이블 4개 감지
    🔧 테이블 bbox 보정됨: 4개 → 4개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1240+218)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1246+272)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1200+418)
    🖼️ 테이블 4 크롭 및 Gemini 전송...
      ✅ 테이블 4 완료 (토큰: 1213+135)

🔄 페이지 7 (7/9) 처리 중...
    📖 컨텍스트 유지: 1-1-4 (PDF 페이지 551)
    📊 테이블 4개 감지
    🔧 테이블 bbox 보정됨: 4개 → 4개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1196+221)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1213+209)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1234+440)
    🖼️ 테이블 4 크롭 및 Gemini 전송...
      ✅ 테이블 4 완료 (토큰: 1246+397)

🔄 페이지 8 (8/9) 처리 중...
    📖 컨텍스트 유지: 1-1-4 (PDF 페이지 552)
    📊 테이블 3개 감지
    🔧 테이블 bbox 보정됨: 3개 → 3개
    🖼️ 테이블 1 크롭 및 Gemini 전송...
      ✅ 테이블 1 완료 (토큰: 1242+246)
    🖼️ 테이블 2 크롭 및 Gemini 전송...
      ✅ 테이블 2 완료 (토큰: 1198+255)
    🖼️ 테이블 3 크롭 및 Gemini 전송...
      ✅ 테이블 3 완료 (토큰: 1240+229)

🔄 페이지 9 (9/9) 처리 중...
    📖 컨텍스트 유지: 1-1-4 (PDF 페이지 553)
    📊 테이블 2개 감지
    🔄 비정상 테이블 감지 → 전체 페이지 Gemini 처리로 전환
    ✅ 전체 페이지 9 Gemini 완료 (토큰: 1216+538)

==================================================
✅ 추출 완료!
==================================================
📄 출력 파일: G:\내 드라이브\AI 활용\n8n_품셈RAG자료\python_code\download_file\20260207_595-603 OKOK_p1-9.md
📊 파일 크기: 32,660 bytes

📈 Gemini 사용량 요약:
   - API 호출: 36회
   - 입력 토큰: 43,968
   - 출력 토큰: 11,828
   - 총 토큰: 55,796
   - 예상 비용 (유료 시): $0.0397 (약 55원)
