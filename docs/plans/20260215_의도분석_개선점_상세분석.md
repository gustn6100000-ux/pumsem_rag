# 의도 분석 시스템 — 노무비 산출 관점 심층 분석

> 작성일: 2026-02-15  
> 목적: 현재 의도 분석 시스템이 노무비 산출 전체 품셈 흐름에서 개선해야 할 점을 식별

---

## 현재 잘 동작하는 영역

| 사용자 입력                  | 현재 intent      | 동작           | 판정 |
| ---------------------------- | ---------------- | -------------- | ---- |
| "강관용접 200mm SCH 40"      | `search`         | 정확 매칭      | ✅    |
| "TIG용접 품셈"               | `clarify_needed` | 규격 선택 제시 | ✅    |
| "용접"                       | `clarify_needed` | 분야 선택 제시 | ✅    |
| "안녕"                       | `greeting`       | 인사 응답      | ✅    |
| "SCH 80은?" (이전: 강관용접) | `followup`       | 규격 변경      | ✅    |

---

## 실제 사용자 질문 vs 현재 시스템 — 15개 시나리오

### 그룹 1: "설명형 질문" (가장 빈번)

| #   | 실제 사용자 입력                         | 현재 문제                                                                 |
| --- | ---------------------------------------- | ------------------------------------------------------------------------- |
| 1   | "8인치 배관 용접하는데 품셈 뭐 써야 해?" | work_name 추출 불명확. "배관 용접"? "강관용접"? "8인치"→"200"? 변환 못 함 |
| 2   | "스테인리스 파이프 이음 작업인데"        | "스테인리스"→TIG용접? 소재 기반 추론 불가                                 |
| 3   | "현장에서 핸드레일 만들어야 하는데"      | "핸드레일"→잡철물? 동의어/연관어 추론 불가                                |
| 4   | "200파이 SCH 40 맞대기 용접"             | "200파이"→"200", "맞대기"→강관용접의 일종. 업계 은어 처리 불가            |

### 그룹 2: "수량/비용 계산 요청"

| #   | 실제 사용자 입력              | 현재 문제                                                         |
| --- | ----------------------------- | ----------------------------------------------------------------- |
| 5   | "아까 건 50m 치면 얼마야?"    | `quantity_input` 분류 됨. BUT "아까 건" = 이전 품셈 entity를 모름 |
| 6   | "인건비만 따로 뽑아줘"        | intent 분류 불가. search? quantity_input? 모호                    |
| 7   | "노무비 산출서 만들어줘"      | 새로운 intent 필요: generate_report                               |
| 8   | "20개소로 바꿔서 다시 계산해" | quantity_input이지만 "바꿔서" = 이전 결과 기반 변경               |

### 그룹 3: "맥락 의존 대화"

| #   | 실제 사용자 입력                     | 현재 문제                                      |
| --- | ------------------------------------ | ---------------------------------------------- |
| 9   | "그거 말고 TIG로 해줘"               | "그거" = 이전 품셈. 이전 맥락(entity_id) 없음  |
| 10  | "규격은 같고 MIG로 바꾸면?"          | "규격은 같고" = 이전 spec 유지. 상태 참조 불가 |
| 11  | "위에서 특별인부 빼면 얼마야?"       | 특정 직종 제외 재산출. 구조화된 데이터 필요    |
| 12  | "아 아까 거푸집이 아니라 철근이었어" | 이전 검색 결과 자체를 번복. work_name 변경     |

### 그룹 4: "단위/은어 변환"

| #   | 실제 사용자 입력 | 변환 필요       | 현재 처리 |
| --- | ---------------- | --------------- | --------- |
| 13  | "8인치"          | → 200mm → "200" | ❌ 미처리  |
| 14  | "200파이"        | → φ200 → "200"  | ❌ 미처리  |
| 15  | "반파이프"       | → 15mm → "15"   | ❌ 미처리  |

---

## 개선 우선순위 매트릭스

| 개선 항목                                        | 영향도 | 구현 난이도 | 우선순위 |
| ------------------------------------------------ | ------ | ----------- | -------- |
| ① session_context 추가 (세션 상태)               | ★★★★★  | 중          | 🔴 1순위  |
| ② intent 세분화 (cost_calculate, modify, report) | ★★★★☆  | 하          | 🔴 1순위  |
| ③ 인치/파이 → mm 변환 (프롬프트 + 후처리)        | ★★★★☆  | 하          | 🟡 2순위  |
| ④ 설명형 질문 → 품셈 추론 (Few-shot 확장)        | ★★★☆☆  | 중          | 🟡 2순위  |
| ⑤ 산출서 생성 전용 intent + 템플릿               | ★★★☆☆  | 중          | 🟢 3순위  |

---

## 결론

1. **세션 상태 관리** — "아까 건", "그거 말고" 같은 참조를 해석하려면 이전 턴의 entity/수량/계산결과를 프론트엔드가 전달해야 함
2. **intent 확장** — 현재 5개 → 8개로. 특히 cost_calculate, modify_request, report_request 추가가 필수
3. **업계 은어 변환** — "8인치", "200파이", "맞대기" 같은 현장 용어를 프롬프트 또는 후처리에서 정규화
