# 리뷰기반 개선작업 상세구현서 — 검토 의견

> **작성일**: 2026-02-23
> **대상**: `20260223_리뷰기반_개선작업_상세구현서.md`
> **결론**: 작업 1~4 구성 논리적, 코드 로직 정확. Critical 전제조건 누락 1건 + 점수 표기 오류 1건 수정 권고

---

## 전반적 평가

변경 3건(A/B/C)의 코드 로직과 TC10 재산출이 정확하고, 검토의견 반영도 올바름. 단 `index.ts` unstaged 회귀 처리가 실행 순서에 누락되어 있어 그대로 배포하면 Route 3.5가 여전히 dead code 상태로 남음.

---

## 이견 없는 항목

**변경 A** (`톤|cm` 추가): `clarify.ts` L54 현재 코드 확인, 제시된 regex 수정 정확.

**변경 B** (`+` 연산자 +1pt): 건설 품셈 도메인에서 `+`의 오용 사례("SCH40+", "150℃+" 등)가 드물고, 단독 +1pt으로는 임계값 4 돌파 불가. 위험도 낮음.

**변경 C** (`산출|산정` + `workMatchCount≥2` 조건부): 검토의견 반영 정확. `detectCostIntent()`의 `COST_KEYWORDS`에 이미 "산출"이 있으나 `classifyComplexity`와 별개 함수이므로 충돌 없음.

**TC10 점수 재산출 (5pt → complex)**: 변경 B +1pt, 변경 C +1pt 추가 계산 정확.

**작업 2** (TC9 표현 수정): 검토의견과 일치.

**작업 3** (`latency_breakdown`): optional 필드이므로 기존 `SearchInfo` 호환성 유지. Phase 3 연기 판단 타당.

---

## 검토 의견 2건

### 의견 1 (Critical) — `index.ts` 회귀 처리 누락

현재 unstaged 변경에 `classifyComplexity` import + call을 **제거**하는 2줄 삭제가 포함되어 있음:

```diff
-    classifyComplexity,
} from "./clarify.ts";

-    analysis.complexity = classifyComplexity(question, analysis);
```

구현서 실행 순서(clarify.ts 수정 → commit → deploy)에 이 회귀의 처리 방법이 없음. 이 상태로 배포하면 `classifyComplexity`가 개선되어도 호출이 없어 Route 3.5는 여전히 dead code.

**권고 — 실행 순서에 0번 단계 추가:**

```
0. index.ts unstaged 변경에서 classifyComplexity 삭제 2줄을 되돌림
   (git restore 또는 수동 복구 후 확인)
1. clarify.ts regex 개선 3건 적용
2. 문서 정정 (TC9 표현)
3. git commit & push
4. deploy
5. TC10 재실행 → Route 3.5 검증
6. 회귀 테스트
7. 결과 문서화
```

---

### 의견 2 (낮음) — 회귀 테스트 점수 표기 오류

`4.3 회귀 테스트` 내 "강관용접 200mm SCH 40 노무비 산출" 점수 계산:

```
현재:  1(길이<30? → 0) + 0 + 0 + 1(200mm→1개뿐) + 0 + 0 = 1pt
정확:  0(길이 24자, <30) + 0 + 0 + 0(200mm 1개, <2) + 0 + 0 = 0pt
```

합산 `= 1pt`는 계산 오류. 결론(simple)은 0pt든 1pt든 동일하므로 기능 영향 없음. 문서 정확도 문제.

---

## 판정 요약

| 항목 | 판정 |
|---|:---:|
| 변경 A (톤/cm regex) | ✅ |
| 변경 B (+연산자) | ✅ |
| 변경 C (산출 조건부) | ✅ |
| TC10 재산출 (5pt) | ✅ |
| 작업 2 문서 정정 | ✅ |
| 작업 3 설계 (P1) | ✅ |
| **index.ts 회귀 처리 누락** | ❌ Critical |
| 회귀 테스트 점수 표기 | ⚠️ 표기 오류 |

`index.ts` 회귀 처리를 실행 순서 0번 단계로 명시한 뒤 진행할 것을 권고함.
