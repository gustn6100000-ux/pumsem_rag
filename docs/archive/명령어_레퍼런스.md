# PDF 추출기 터미널 명령어 레퍼런스 (v3.3)

## 작업 폴더 이동

```powershell
cd "G:\내 드라이브\AI 활용\n8n_품셈RAG자료"
```

---

## 기본 명령어

### 하이브리드 모드 (텍스트 + 테이블)

```powershell
py python_code\step1_extract_gemini_v33.py "업로드 자료\00. 파싱 자료\PDF파일\파일명.pdf"
```

### 텍스트 전용 모드 (빠름, API 비용 없음)

```powershell
py python_code\step1_extract_gemini_v33.py -t "업로드 자료\00. 파싱 자료\PDF파일\파일명.pdf"
```

---

## 옵션

| 옵션 | 설명 |
|------|------|
| `--text-only`, `-t` | 텍스트 전용 모드 (Gemini API 미사용) |
| `--pages <지정>` | 처리할 페이지 지정 |
| `--toc <파일>` | 목차 파일 경로 (JSON 또는 MD) |

---

## 페이지 지정 (`--pages`)

| 형식 | 의미 |
|------|------|
| `--pages 15` | 1~15페이지 |
| `--pages 16-30` | 16~30페이지 |
| `--pages 1,3,5-10` | 1, 3, 5~10페이지 |
| `--pages 20-` | 20페이지~끝 |

---

## 실제 사용 예시

```powershell
# 16~22 페이지만 추출 (하이브리드 + 목차 연동)
py python_code\step1_extract_gemini_v33.py --pages 16-22 --toc "업로드 자료\00. 파싱 자료\PDF파일\toc_parsed.json" "업로드 자료\00. 파싱 자료\PDF파일\53-83 OKOK.pdf"

# 텍스트만 빠르게 추출
py python_code\step1_extract_gemini_v33.py -t "업로드 자료\00. 파싱 자료\PDF파일\53-83 OKOK.pdf"

# 앞부분 5페이지만 테스트
py python_code\step1_extract_gemini_v33.py --pages 5 "업로드 자료\00. 파싱 자료\PDF파일\53-83 OKOK.pdf"
```

---

## 출력 결과

| 파일 | 위치 | 형식 |
|------|------|------|
| 마크다운 결과 | `python_code/download_file/` 폴더 | `YYYYMMDD_원본파일명_p시작-끝.md` |
| 실행 로그 | `python_code/step1_log.txt` | - |

**예시:**
- 입력: `53-83 OKOK.pdf` (16-22페이지)
- 출력: `python_code/download_file/20260206_53-83 OKOK_p16-22.md`
- 중복 시: `20260206_53-83 OKOK_p16-22_1.md`

---

## v3.3 개선사항

| 항목 | 설명 |
|------|------|
| **CONTEXT 마커** | 섹션 계속 페이지에 현재 섹션 정보 표시 |
| **파일명 개선** | 날짜, 원본파일명, 페이지범위 포함 |
| **저장 위치** | `download_file/` 폴더에 자동 저장 |
| **중복 처리** | 동일 파일명 시 숫자 접미사 추가 |
| **텍스트 줄바꿈** | 문장 종결 감지로 과도한 병합 방지 |
| **테이블 크롭** | 아래쪽 패딩 확대 (본문 잘림 방지) |
| **bbox 검증** | 비정상 테이블 → 전체 페이지 Gemini 폴백 |

---

## 출력 마커 설명

```markdown
<!-- PAGE 16 | 공통부문 > 제1장 적용기준 -->       ← 페이지 컨텍스트
<!-- SECTION: 1-3-1 | 재료의 할증 | ... -->       ← 새 섹션 시작
<!-- CONTEXT: 1-3-1 | 재료의 할증 | ... -->       ← 섹션 계속 (RAG 청킹용)
```

---

## 도움말

```powershell
py python_code\step1_extract_gemini_v33.py
```
