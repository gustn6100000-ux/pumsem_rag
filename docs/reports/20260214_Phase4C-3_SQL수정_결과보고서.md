# Phase 4C-3: SQL 기반 데이터 수정 결과 보고서

> **완료 일시**: 2026-02-14 09:55 KST  
> **방식**: 절충안 C — SQL 직접 수정 (SCH 오기 + 공백 정규화)  
> **백업**: `backup_4c3_entities` 테이블 (964건)

---

## 수정 결과 요약

| 항목                            | 수정 건수                   | 결과   |
| ------------------------------- | --------------------------- | ------ |
| **(a) entities SCH 제거**       | 939건 → 잔존 0건            | ✅ 완료 |
| **(a) relationships SCH 제거**  | properties.work_type_name   | ✅ 완료 |
| **(e) 공백 정규화** (숫자+단위) | 90그룹 → 77그룹 (13건 해소) | ⚠️ 부분 |
| **화이트리스트 보호**           | 357건 유지                  | ✅ 정상 |

---

## 검증 결과

| #   | 검증 항목               | 값         | 판정        |
| --- | ----------------------- | ---------- | ----------- |
| 1   | 비화이트리스트 SCH 잔존 | **0건**    | ✅ Pass      |
| 2   | 화이트리스트 SCH 보호   | **357건**  | ✅ Pass      |
| 3   | 공백 중복 그룹          | **77그룹** | ⚠️ 부분 해결 |
| 4   | 백업 건수               | **964건**  | ✅ 확인      |
| 5   | Relationships SCH 잔존  | **0건**    | ✅ Pass      |

---

## 수정 전/후 비교 샘플

| 수정 전 (SCH 포함)                                               | 수정 후                                      |
| ---------------------------------------------------------------- | -------------------------------------------- |
| 크러셔(100, **SCH 139076**)                                      | 크러셔(100, **139076**)                      |
| 구획정리 확정측량(가구계산, **SCH 번 화 지 구**)                 | 구획정리 확정측량(가구계산, **번 화 지 구**) |
| 경지구획정리 신규등록 측량(수치)(결과도작성, **SCH 지적기능사**) | ~(결과도작성, **지적기능사**)                |
| 냉동기 반입(10, **SCH 1회**)                                     | 냉동기 반입(10, **1회**)                     |
| 용접공수 산정방법(판두께(mm), **SCH 10**)                        | 용접공수 산정방법(판두께(mm), **10**)        |

---

## 미완료 항목 (파이프라인 재추출 시 해결)

| 항목                        | 이유                         | 대안                         |
| --------------------------- | ---------------------------- | ---------------------------- |
| **(b) source_chunk**        | SQL만으로 불가               | 파이프라인 재추출 시 자동    |
| **(c) 소제목 V형/U형**      | Phase 4B 수동 패치 완료      | 재추출 시 자동               |
| **(d) 빈 텍스트 보충**      | chunk 테이블 구조상 SQL 불가 | 재추출 시 자동               |
| **(e) 잔여 77개 공백 그룹** | 한글 공백은 의미 훼손 위험   | 재추출 시 정규화 함수로 처리 |

---

## 롤백 방법

```sql
-- 롤백: 백업에서 원본 이름 복원
UPDATE graph_entities e
SET name = b.name
FROM backup_4c3_entities b
WHERE e.id = b.id;
```
