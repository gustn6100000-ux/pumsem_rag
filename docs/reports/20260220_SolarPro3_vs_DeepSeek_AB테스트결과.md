# Solar Pro 3 vs DeepSeek-V3 A/B 테스트 결과 보고서

> **테스트 일시**: 2026-02-19 23:59  
> **샘플 수**: 12 청크 (text_only 3, a_table 3, d_matrix 3, empty_text 3)  
> **결과 파일**: `phase2_output/_ab_test/ab_test_20260219_2359.json`

---

## 1. 핵심 결과 요약

| 항목                 | DeepSeek-V3  | Solar Pro 3  |      차이       |
| :------------------- | :----------: | :----------: | :-------------: |
| **성공률**           | 12/12 (100%) | 12/12 (100%) |      동일       |
| **총 엔티티**        |     109      |   **150**    | **Solar +37%**  |
| **총 관계**          |   **258**    |     232      |     DS +11%     |
| **source_spec 포함** |   **210**    |     203      |     DS +3%      |
| **총 시간**          |   **452s**   |     723s     |  DS 1.6x 빠름   |
| **평균 TPS**         |     54.2     |   **89.5**   | Solar 1.7x 높음 |
| **총 Output 토큰**   |    24,521    |  **64,778**  | Solar 2.6x 많음 |

> **참고**: Solar가 TPS가 높은 이유는 출력 토큰이 2.6배 많기 때문. 실제 응답 완료 시간은 DeepSeek이 1.6배 빠름.

---

## 2. 엔티티 유형별 분포

| 유형          | DeepSeek | Solar  | Solar 우위 |
| :------------ | :------: | :----: | :--------: |
| **WorkType**  |    12    | **22** |  **+83%**  |
| **Labor**     |  **23**  |   21   |    -9%     |
| **Equipment** |    13    |   15   |    +15%    |
| **Material**  |    20    | **29** |  **+45%**  |
| **Note**      |    36    | **57** |  **+58%**  |
| **Standard**  |    5     |   6    |    +20%    |

> Solar가 WorkType, Note, Material을 더 세분화하여 추출. 한국어 전문 용어 인식이 더 정밀한 것으로 해석됨.

---

## 3. 관계 유형별 분포

| 유형                   | DeepSeek |  Solar  |    우위     |
| :--------------------- | :------: | :-----: | :---------: |
| **REQUIRES_LABOR**     |   110    | **116** |  Solar +5%  |
| **REQUIRES_EQUIPMENT** |  **61**  |   19    | **DS 3.2x** |
| **USES_MATERIAL**      |    36    | **39**  |  Solar +8%  |
| **HAS_NOTE**           |    46    | **52**  | Solar +13%  |
| **APPLIES_STANDARD**   |    5     |    6    |    유사     |

> **주의**: DeepSeek이 `REQUIRES_EQUIPMENT` 관계를 3.2배 더 많이 생성(61 vs 19). 정확한 추출인지 과잉 추출인지는 원본 데이터 대조 필요.

---

## 4. 청크별 상세 비교

|   #   | Chunk                   | 유형       |  DS E/R   |  SL E/R   |  DS sec  |  SL sec  |      판정       |
| :---: | :---------------------- | :--------- | :-------: | :-------: | :------: | :------: | :-------------: |
|   1   | C-0944-B 플랜트 배관    | text_only  |   16/19   | **27/26** |   44.3   |   88.7   |   Solar 우위    |
|   2   | C-0112 CCTV 설치        | text_only  |    6/5    |    5/4    | **15.0** |   74.2   |      유사       |
|   3   | C-0010-B 재료 단가      | text_only  |    6/5    |  **8/7**  | **12.6** |   38.5   | Solar 약간 우위 |
|   4   | C-0493 표준관입시험     | a_table    | **13/12** |   11/10   | **24.1** |   68.2   |     DS 우위     |
|   5   | C-0414 테르밋 용접      | a_table    |   17/22   | **19/18** | **42.4** |   65.4   |      비슷       |
|   6   | C-0372-B 방음벽         | a_table    | 5/**23**  | **10**/21 | **42.2** |   67.7   |      혼합       |
|   7   | C-0281-A-b 유압파일해머 | d_matrix   |  **9/6**  |    3/6    | **17.7** |   58.5   |     DS 우위     |
|   8   | C-1007 Castable Spray   | d_matrix   | **8/19**  |   4/14    | **34.8** |   50.6   |     DS 우위     |
|   9   | C-0270-D 크러셔         | d_matrix   | 9/**46**  | **37**/30 |   57.2   |   66.7   | **혼합 (핵심)** |
|  10   | C-0959-N 아세틸렌 환산  | empty_text | 9/**62**  | 10/**60** |   98.7   | **59.7** |      유사       |
|  11   | C-0619-A-c 도시계획     | empty_text | 5/**34**  | **11**/33 | **49.9** |   61.6   |      혼합       |
|  12   | C-0281-A-h 유압파일해머 | empty_text |    6/5    |    5/3    | **13.3** |   23.5   |     DS 우위     |

---

## 5. 매트릭스 전개 능력 비교 (핵심)

### matrix_analysis_scratchpad 비교

| Chunk                   | DeepSeek                                    | Solar                             |
| :---------------------- | :------------------------------------------ | :-------------------------------- |
| C-0372-B 방음벽         | "4규격 × 7행 = 28관계" (상세)               | "7규격 × 4직종 = 28관계" (간결)   |
| C-0281-A-b 유압파일해머 | "2규격 × 6파일경 = 12관계. 실제 6개" (정밀) | "2규격 × 6파일경 = 12관계" (동일) |
| C-1007 Castable         | "7규격 × 2직종 = 14관계"                    | "7규격 × 2직종 = 14관계"          |
| C-0270-D 크러셔         | "8규격 × 6출구 = 48관계"                    | "8규격 × 6출구 = 48관계"          |

> 두 모델 모두 매트릭스 전개 사고 과정은 정확. 실제 생성된 관계 수에서 DeepSeek이 더 많이 실현(DS 46 vs SL 30 at C-0270-D).

---

## 6. 주요 발견

### ✅ Solar Pro 3의 강점
1. **엔티티 세분화**: WorkType +83%, Material +45%, Note +58% — 한국어 전문 용어를 더 세밀하게 분리
2. **높은 confidence**: 대부분 0.95 (DS는 0.9)
3. **한국어 공백 처리**: "보 온 공", "특 별 인 부"까지 정확히 인식하여 공백이 포함된 한국어도 처리

### ⚠️ Solar Pro 3의 약점
1. **속도 1.6x 느림**: 평균 60.3s/chunk (DS 37.7s/chunk)
2. **REQUIRES_EQUIPMENT 3.2x 적음**: 장비 관계 추출 누락 가능성 (61 vs 19)
3. **d_matrix 관계 생성 부족**: DS 46R vs SL 30R at 크러셔 — scratchpad에서 48개 전개 계획했지만 실제 30개만 생성
4. **Output 토큰 2.6x 많음**: 무료 기간 후 비용에 직접 영향

---

## 7. 비용 분석

### 현재 (3월 2일까지)

| 모델        |                2,000건 처리 비용                 |
| :---------- | :----------------------------------------------: |
| DeepSeek-V3 | ~$5 (input $0.28/M × ~5M + output $0.42/M × ~5M) |
| Solar Pro 3 |                  **$0** (무료)                   |

### 3월 2일 이후 (예상)

| 모델        |           2,000건 예상 비용           |
| :---------- | :-----------------------------------: |
| DeepSeek-V3 |                  ~$5                  |
| Solar Pro 3 | ~$7-15 (output 2.6x → 비용 비례 증가) |

---

## 8. 테스트 중 발견한 기술적 이슈

### max_tokens 잘림 문제
- **현상**: Solar의 `max_tokens=4096` 설정 시 JSON 출력이 잘려 Pydantic validation 실패 (첫 A/B 테스트에서 ~60% 실패)
- **원인**: Solar Pro 3은 DeepSeek보다 output 토큰을 2.6배 많이 생성 → 4096으로는 부족
- **해결**: `max_tokens=8192`로 변경 후 100% 성공
- **교훈**: Solar 적용 시 반드시 `max_tokens ≥ 8192` 설정 필요

---

## 9. 최종 권고

> **즉시 전환은 비권장.** Solar Pro 3은 한국어 엔티티 인식에서 강점이 있으나, 관계 생성 완전성(특히 REQUIRES_EQUIPMENT, 매트릭스 전개)에서 DeepSeek-V3가 우수.

### 권장 전략

| 우선순위 | 행동                                   | 이유                                                         |
| :------: | :------------------------------------- | :----------------------------------------------------------- |
|    1     | **DeepSeek-V3로 전체 재추출**          | 관계 생성 완전성 + 속도 우위 + 검증된 안정성                 |
|    2     | Solar로 **엔티티 보강 2차 패스**       | Solar의 세분화된 엔티티(Note, Material)를 추가 추출하여 병합 |
|    3     | 3월 2일 전에 Solar 가격 확인 후 재평가 | 가격이 합리적이면 하이브리드 파이프라인 구축 검토            |

### 조건부 Solar 전환 가능 시나리오
- Solar의 `REQUIRES_EQUIPMENT` 누락이 **프롬프트 최적화로 해결 가능**한 경우
- 3월 이후 Solar 가격이 DeepSeek 대비 **1.5x 이내**인 경우
- **속도가 크리티컬하지 않은** 배치 처리 전용인 경우
